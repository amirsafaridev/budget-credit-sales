# افزونه فروش اعتباری باجت برای ووکامرس

افزونه‌ای برای افزودن قابلیت فروش اعتباری در فرآیند تسویه‌حساب فروشگاه ووکامرس.

## ویژگی‌ها

### بخش کاربری (Front-End)

1. **فیلد انتخاب نوع فروش در Checkout**
   - گزینه "عادی" (پیش‌فرض)
   - گزینه "باجت" (فروش اعتباری)
   - محاسبه خودکار 12% افزایش قیمت در حالت باجت

2. **کنترل درگاه‌های پرداخت**
   - در حالت عادی: تمام درگاه‌های پرداخت فعال
   - در حالت باجت: فقط درگاه‌های مجاز فعال می‌شوند

3. **پرداخت ترکیبی**
   - اگر اعتبار کاربر >= مبلغ خرید: پرداخت کامل از طریق باجت
   - اگر اعتبار کاربر < مبلغ خرید: پرداخت بخشی از باجت + هدایت به درگاه دیگر

4. **شورتکد انتخاب نوع فروش**
   - شورتکد: `[arta_budget_sale_type_selector]`
   - قابل استفاده در هدر سایت
   - نمایش قیمت‌ها با 12% افزایش در حالت باجت
   - جلوگیری از تغییر نوع فروش در صورت وجود کالا در سبد خرید

### بخش مدیریت (Back-End)

1. **تنظیمات درگاه‌ها**
   - لیست تمام درگاه‌های پرداخت فعال
   - فعال/غیرفعال کردن درگاه‌ها برای حالت باجت
   - تعیین درگاه پیش‌فرض برای پرداخت مرحله دوم

2. **مدیریت کاربران و اعتبار**
   - نمایش لیست کاربران و اعتبار فعلی هر کاربر
   - ویرایش دستی اعتبار کاربران
   - مشاهده تاریخچه تغییرات اعتبار

## نصب

1. فایل افزونه را در پوشه `wp-content/plugins/` قرار دهید
2. افزونه را از بخش افزونه‌های وردپرس فعال کنید
3. اطمینان حاصل کنید که ووکامرس نصب و فعال است

## استفاده

### تنظیمات اولیه

1. به **فروش اعتباری باجت > تنظیمات درگاه‌ها** بروید
2. درگاه‌های مجاز برای حالت باجت را انتخاب کنید
3. درگاه پیش‌فرض برای پرداخت مرحله دوم را تعیین کنید

### مدیریت اعتبار کاربران

1. به **فروش اعتباری باجت > مدیریت کاربران و اعتبار** بروید
2. کاربر مورد نظر را انتخاب کنید
3. اعتبار جدید را وارد کرده و ذخیره کنید

### استفاده از شورتکد

شورتکد `[arta_budget_sale_type_selector]` را در هر جایی که می‌خواهید (مثلاً در هدر سایت) قرار دهید.

## ساختار فایل‌ها

```
arta-budget-credit-sales/
├── arta-budget-credit-sales.php (فایل اصلی)
├── includes/
│   ├── class-database.php (مدیریت پایگاه داده)
│   ├── class-checkout.php (تغییرات صفحه Checkout)
│   ├── class-payment-gateways.php (کنترل درگاه‌های پرداخت)
│   ├── class-payment-handler.php (مدیریت پرداخت ترکیبی)
│   ├── class-shortcode.php (شورتکد)
│   └── admin/
│       ├── class-admin-settings.php (صفحه تنظیمات)
│       └── class-user-credit.php (مدیریت اعتبار)
└── assets/
    ├── js/
    │   ├── checkout.js
    │   ├── shortcode.js
    │   └── admin.js
    └── css/
        ├── checkout.css
        ├── shortcode.css
        └── admin.css
```

## نیازمندی‌ها

- WordPress 5.0 یا بالاتر
- WooCommerce 3.0 یا بالاتر
- PHP 7.2 یا بالاتر

## نکات مهم

1. شناسه درگاه باجت (کالانو) باید در تنظیمات درگاه‌ها بررسی شود و در صورت نیاز تغییر یابد.
2. درگاه‌های پرداخت باید از قبل در ووکامرس نصب و فعال باشند.
3. تاریخچه تغییرات اعتبار در جدول `wp_arta_budget_credit_history` ذخیره می‌شود.

## پشتیبانی

برای گزارش مشکلات یا پیشنهادات، لطفاً با تیم توسعه تماس بگیرید.

